package com.amadeus.droolsfeature;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.InputStream;

import org.apache.log4j.Logger;
import org.drools.decisiontable.InputType;
import org.drools.decisiontable.SpreadsheetCompiler;

public class DecisionTableTools {
	private static Logger logger = Logger.getLogger(DecisionTableTools.class);

	public  void generateDrlFromXLSDt() {
		// create an input stream
		InputStream is = null;
		try {
			is = new FileInputStream(System.getProperty("user.dir") + "/src/main/resources/com/amadeus/dtables/test.xls");
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
		// create compiler class instance
		SpreadsheetCompiler sc = new SpreadsheetCompiler();
		// compile the excel to generate the (.drl)
		String drl = sc.compile(is, InputType.XLS);
		// check the generated (.drl) 
		logger.info("Generate DRL file is â€“: ");
		logger.info(drl);
	}
}
